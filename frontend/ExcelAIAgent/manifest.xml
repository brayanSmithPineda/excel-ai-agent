<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!-- 
  Office Add-in Manifest File
  This XML file defines the add-in's metadata, permissions, and UI integration points.
  Excel uses this file to understand how to load and display the add-in.
-->
<OfficeApp 
  xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" 
  xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" 
  xsi:type="TaskPaneApp">
  
  <!-- Unique identifier for this add-in - generated GUID that Excel uses to track the add-in -->
  <!-- This ID must remain constant across updates to preserve user data and settings -->
  <Id>0207917d-a675-41fd-93d8-5535c14f51bb</Id>
  
  <!-- Version number of the add-in - follows semantic versioning (major.minor.patch.build) -->
  <!-- Excel uses this to determine if updates are available -->
  <Version>1.0.0.0</Version>
  
  <!-- Provider/Company name - displayed in Excel's add-in management interface -->
  <ProviderName>Excel AI Agent Team</ProviderName>
  
  <!-- Default language/locale for the add-in - used for localization -->
  <DefaultLocale>en-US</DefaultLocale>
  
  <!-- Display name shown in Excel's ribbon and add-in lists -->
  <DisplayName DefaultValue="Excel AI Assistant"/>
  
  <!-- Description shown in Excel's add-in store and management interface -->
  <Description DefaultValue="Secure AI-powered assistant for Excel with data cleaning, business integrations, and audit logging for finance teams."/>
  
  <!-- Icon URLs - Excel displays these in various UI contexts -->
  <!-- 32x32 icon used in ribbon and task pane headers -->
  <IconUrl DefaultValue="https://localhost:3000/assets/icon-32.png"/>
  <!-- 64x64 high-resolution icon for high-DPI displays -->
  <HighResolutionIconUrl DefaultValue="https://localhost:3000/assets/icon-64.png"/>
  
  <!-- Support URL - where users can get help with the add-in -->
  <SupportUrl DefaultValue="https://github.com/yourusername/excel-ai-agent/wiki"/>
  
  <!-- Domains that the add-in is allowed to navigate to or make requests from -->
  <!-- This is a security feature to prevent malicious redirects -->
  <AppDomains>
    <AppDomain>https://localhost:3000</AppDomain>
    <!-- Add your backend domain here when deploying to production -->
    <!-- <AppDomain>https://your-backend-api.com</AppDomain> -->
  </AppDomains>
  
  <!-- Specifies which Office applications can load this add-in -->
  <!-- "Workbook" means Excel specifically (not Word, PowerPoint, etc.) -->
  <Hosts>
    <Host Name="Workbook"/>
  </Hosts>
  
  <!-- Default settings for the add-in when it loads -->
  <DefaultSettings>
    <!-- Primary HTML file that loads when the task pane opens -->
    <!-- This URL must be HTTPS in production -->
    <SourceLocation DefaultValue="https://localhost:3000/taskpane.html"/>
  </DefaultSettings>
  
  <!-- Permissions requested by the add-in -->
  <!-- ReadWriteDocument allows full access to Excel workbook content -->
  <!-- This is required for our AI assistant to read data and make changes -->
  <Permissions>ReadWriteDocument</Permissions>
  
  <!-- Office JavaScript API requirement sets specification -->
  <!-- Defines the minimum API versions required for this AI assistant add-in to function -->
  <!-- IMPORTANT: When adding new features, always verify the required API version at: -->
  <!-- https://docs.microsoft.com/en-us/office/dev/add-ins/reference/requirement-sets/ -->
  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <!-- ExcelApi 1.3 - Core Excel functionality: worksheets, ranges, tables, data manipulation -->
      <!-- Supports Office 2016 and later, Microsoft 365 -->
      <Set Name="ExcelApi" MinVersion="1.3"/>
      
      <!-- IdentityApi 1.3 - Authentication and identity management for JWT auth with backend -->
      <!-- Enables secure authentication flows and token management -->
      <Set Name="IdentityApi" MinVersion="1.3"/>
      
      <!-- DialogApi 1.2 - Dialog boxes for authentication flows and user confirmations -->
      <!-- Required for OAuth flows, data preview dialogs, and user consent -->
      <Set Name="DialogApi" MinVersion="1.2"/>
      
      <!-- SharedRuntime 1.1 - Shared runtime for persistent state and WebSocket connections -->
      <!-- Enables maintaining AI chat state and real-time backend communication -->
      <Set Name="SharedRuntime" MinVersion="1.1"/>
    </Sets>
    
    <!-- Individual API methods not covered by requirement sets -->
    <!-- Used for specific functionality like settings storage and dialog management -->
    <Methods>
      <!-- Settings storage methods for user preferences and authentication tokens -->
      <Method Name="Office.context.document.settings.saveAsync"/>
      <Method Name="Office.context.document.settings.refreshAsync"/>
      
      <!-- Dialog management methods for authentication flows and user interactions -->
      <Method Name="Office.context.ui.displayDialogAsync"/>
      <Method Name="Office.context.ui.messageParent"/>
    </Methods>
  </Requirements>
  
  <!-- VersionOverrides section defines modern UI integration with Excel ribbon -->
  <!-- This replaces the basic DefaultSettings for newer Excel versions -->
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xsi:type="VersionOverridesV1_0">
    
    <!-- Host-specific configurations for different Office applications -->
    <Hosts>
      <!-- Configuration specific to Excel workbooks -->
      <Host xsi:type="Workbook">
        
        <!-- Desktop form factor configuration (Excel desktop application) -->
        <DesktopFormFactor>
          
          <!-- Get Started experience - shown when user first installs the add-in -->
          <GetStarted>
            <!-- Title of the welcome message -->
            <Title resid="GetStarted.Title"/>
            <!-- Description explaining how to use the add-in -->
            <Description resid="GetStarted.Description"/>
            <!-- URL for more information about the add-in -->
            <LearnMoreUrl resid="GetStarted.LearnMoreUrl"/>
          </GetStarted>
          
          <!-- FunctionFile - HTML page that handles ribbon button clicks and commands -->
          <!-- This file runs JavaScript functions when users click ribbon buttons -->
          <FunctionFile resid="Commands.Url"/>
          
          <!-- Extension point defines where the add-in appears in Excel's UI -->
          <!-- PrimaryCommandSurface means it appears in the main Excel ribbon -->
          <ExtensionPoint xsi:type="PrimaryCommandSurface">
            
            <!-- Specifies which ribbon tab to add our controls to -->
            <!-- TabHome is the default "Home" tab in Excel -->
            <OfficeTab id="TabHome">
              
              <!-- Group of controls within the ribbon tab -->
              <!-- Excel groups related controls together visually -->
              <Group id="CommandsGroup">
                <!-- Label for the control group -->
                <Label resid="CommandsGroup.Label"/>
                
                <!-- Icon for the group (appears in collapsed state) -->
                <Icon>
                  <!-- 16x16 icon for small ribbon views -->
                  <bt:Image size="16" resid="Icon.16x16"/>
                  <!-- 32x32 icon for normal ribbon views -->
                  <bt:Image size="32" resid="Icon.32x32"/>
                  <!-- 80x80 icon for large ribbon views -->
                  <bt:Image size="80" resid="Icon.80x80"/>
                </Icon>
                
                <!-- Individual button control within the group -->
                <Control xsi:type="Button" id="TaskpaneButton">
                  <!-- Text displayed on the button -->
                  <Label resid="TaskpaneButton.Label"/>
                  
                  <!-- Tooltip that appears when hovering over the button -->
                  <Supertip>
                    <!-- Title of the tooltip -->
                    <Title resid="TaskpaneButton.Label"/>
                    <!-- Description text in the tooltip -->
                    <Description resid="TaskpaneButton.Tooltip"/>
                  </Supertip>
                  
                  <!-- Icons for the button at different sizes -->
                  <Icon>
                    <bt:Image size="16" resid="Icon.16x16"/>
                    <bt:Image size="32" resid="Icon.32x32"/>
                    <bt:Image size="80" resid="Icon.80x80"/>
                  </Icon>
                  
                  <!-- Action taken when the button is clicked -->
                  <!-- ShowTaskpane opens the add-in's task pane -->
                  <Action xsi:type="ShowTaskpane">
                    <!-- Unique ID for this task pane instance -->
                    <TaskpaneId>ButtonId1</TaskpaneId>
                    <!-- URL to load in the task pane -->
                    <SourceLocation resid="Taskpane.Url"/>
                  </Action>
                </Control>
              </Group>
            </OfficeTab>
          </ExtensionPoint>
        </DesktopFormFactor>
      </Host>
    </Hosts>
    <!-- Resources section defines all strings, URLs, and images referenced by ID -->
    <!-- This allows for localization and centralized resource management -->
    <Resources>
      
      <!-- Image resources - all icons used by the add-in -->
      <!-- Excel displays these icons in different contexts and sizes -->
      <bt:Images>
        <!-- Small 16x16 icon for compact ribbon views and menus -->
        <bt:Image id="Icon.16x16" DefaultValue="https://localhost:3000/assets/icon-16.png"/>
        <!-- Standard 32x32 icon for normal ribbon display -->
        <bt:Image id="Icon.32x32" DefaultValue="https://localhost:3000/assets/icon-32.png"/>
        <!-- Large 80x80 icon for expanded ribbon views and high DPI displays -->
        <bt:Image id="Icon.80x80" DefaultValue="https://localhost:3000/assets/icon-80.png"/>
      </bt:Images>
      
      <!-- URL resources - all web pages used by the add-in -->
      <!-- These must be HTTPS URLs in production for security -->
      <bt:Urls>
        <!-- Link to documentation/help for the get started experience -->
        <bt:Url id="GetStarted.LearnMoreUrl" DefaultValue="https://github.com/yourusername/excel-ai-agent/wiki"/>
        <!-- HTML page that handles ribbon button commands and functions -->
        <!-- This page runs background JavaScript when buttons are clicked -->
        <bt:Url id="Commands.Url" DefaultValue="https://localhost:3000/commands.html"/>
        <!-- Main task pane HTML page - the primary UI of the add-in -->
        <!-- This contains our React application for the AI assistant -->
        <bt:Url id="Taskpane.Url" DefaultValue="https://localhost:3000/taskpane.html"/>
      </bt:Urls>
      
      <!-- Short strings - text labels with character limits (less than 125 characters) -->
      <!-- Used for button labels, group names, and short descriptions -->
      <bt:ShortStrings>
        <!-- Title shown in the initial welcome experience -->
        <bt:String id="GetStarted.Title" DefaultValue="Welcome to Excel AI Assistant!"/>
        <!-- Label for the ribbon group containing our controls -->
        <bt:String id="CommandsGroup.Label" DefaultValue="AI Assistant"/>
        <!-- Text displayed on the ribbon button -->
        <bt:String id="TaskpaneButton.Label" DefaultValue="Open AI Assistant"/>
      </bt:ShortStrings>
      
      <!-- Long strings - longer text descriptions (up to 250 characters) -->
      <!-- Used for detailed descriptions, tooltips, and help text -->
      <bt:LongStrings>
        <!-- Description shown in the get started experience -->
        <bt:String id="GetStarted.Description" DefaultValue="Your AI Assistant is ready! Click 'Open AI Assistant' in the Home ribbon to start using secure AI features for data cleaning and business integrations."/>
        <!-- Tooltip text when hovering over the ribbon button -->
        <bt:String id="TaskpaneButton.Tooltip" DefaultValue="Open the AI Assistant task pane for data cleaning, business integrations, and intelligent Excel assistance"/>
      </bt:LongStrings>
    </Resources>
  </VersionOverrides>
</OfficeApp>